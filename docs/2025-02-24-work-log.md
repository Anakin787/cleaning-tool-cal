# 2025년 2월 24일 작업 내역

> 우리들의 모임 (cleaning-tool-cal) 프로젝트 개발 작업 로그

---

## 1. 프로젝트 실행 환경 구성

### 배경
- `main.ts` 파일이 React 컴포넌트로 작성되어 있었으나, 실행에 필요한 프로젝트 구조가 없었음

### 작업 내용
- **Vite + React + TypeScript** 프로젝트 구성
- `package.json`, `vite.config.ts`, `tsconfig.json` 생성
- 프로젝트 구조 정리:
  - `src/App.tsx` - 메인 앱 컴포넌트
  - `src/main.tsx` - React 진입점
  - `src/config.ts` - Firebase 설정
  - `index.html` - Tailwind CSS CDN 포함
- Tailwind CSS를 CDN 방식으로 적용 (PostCSS 의존성 이슈 회피)

### 실행 방법
```bash
npm install
npm run dev
```

---

## 2. Firebase 설정 연동

### 작업 내용
- `src/config.ts`에 Firebase 프로젝트 설정 적용
- 프로젝트: `cleanning-tool-cal`
- 인증 실패 시 사용자 친화적 에러 메시지 표시

---

## 3. 일정 참여/불참/미정 기능

### 추가된 기능
- **참석** 버튼: 일정 참석 예정 표시 (초록색)
- **불참** 버튼: 불참 예정 표시 (빨간색)
- **미정** 버튼: 미정 표시 (주황색)

### 구현 방식
- Firestore에 `attendees`, `notAttendees`, `undecided` 배열로 저장
- 각 버튼별 인원 수 실시간 표시
- 한 번에 하나의 응답만 선택 가능 (선택 변경 시 이전 응답 자동 취소)

---

## 4. 날짜/시간 표시 형식 변경

### 변경 사항
- **날짜**: 한국식 형식 (예: `2025년 2월 24일`)
- **시간**: 24시간 형식 (예: `14:30`, `09:00`)
- `formatDateKO()`, `formatTime24()` 헬퍼 함수 추가
- 시간 입력 필드에 "24시간 형식" 라벨 추가

---

## 5. 투표 기능 확장

### 중복 투표 허용
- 투표 생성 시 "중복 투표 허용" 체크박스 추가
- 활성화 시 여러 항목 동시 선택/해제 가능 (토글 방식)
- `votedUserOptions`로 사용자별 선택 항목 추적

### 익명 투표
- "익명 투표" 체크박스 추가
- 활성화 시 참여 인원 수 숨김

### 항목 추가 허용
- **투표 생성 시**: "+ 항목 추가" 버튼으로 항목 자유 추가/삭제
- **투표 진행 중**: "항목 추가 허용" 체크 시 기존 투표에 새 항목 추가 가능
- `addOptionToPoll()` 함수 구현

---

## 6. 일정 수정 기능

### 작업 내용
- 일정 카드에 **수정(연필)** 버튼 추가
- `startEditSchedule()`, `updateSchedule()`, `cancelEditSchedule()` 함수 구현
- 수정 시 기존 데이터가 폼에 자동 입력
- Firestore `updateDoc`으로 일정 업데이트

---

## 7. 캘린더 뷰

### 초기 구현
- 일정 탭에 "목록" / "캘린더" 전환 탭 추가
- 월간 달력 그리드 (일~토)
- 이전/다음 월 네비게이션
- 날짜별 일정 표시, 클릭 시 수정 화면

### 레이아웃 변경 (오른쪽 사이드바)
- 캘린더를 **오른쪽 여백(사이드바)** 에 고정 배치
- 모든 탭(홈/일정/투표)에서 항상 캘린더 표시
- `md` 이상 화면에서만 사이드바 표시 (모바일 숨김)
- `sticky`로 스크롤 시 상단 고정

### 캘린더 크기 조정
- 사이드바 너비: `w-64` → `w-80` (md), `w-96` (xl)
- 셀 최소 높이: `52px` → `68px`
- 날짜 숫자, 일정 텍스트 크기 확대
- 날짜당 표시 일정: 2개 → 3개

---

## 8. UI/UX 개선

### 홈 화면
- 일정 카드의 **">" (ChevronRight)** 아이콘 클릭 시 일정 수정 화면으로 이동
- 버튼에 hover 스타일 적용

### 일정 수정 시 목록 동작
- 수정 중인 일정은 목록에서 **제외**하여 중복 표시 방지
- `schedules.filter(s => s.id !== editingScheduleId)` 적용

### Live Sync 표시
- 우측 상단 "Live Sync On" 옆에 **초록색 동그란 아이콘** 추가
- `animate-ping` 효과로 연결 상태 시각화

---

## 9. Git 및 배포

### GitHub 저장소
- 저장소: https://github.com/Anakin787/cleaning-tool-cal
- `.gitignore` 생성 (node_modules, dist, .env 등 제외)

### GitHub Actions - GitHub Pages
- `.github/workflows/deploy.yml` 생성
- `main` 브랜치 push 시 자동 빌드 및 배포
- `vite.config.ts`에 `base: '/cleaning-tool-cal/'` 설정
- 배포 URL: `https://anakin787.github.io/cleaning-tool-cal/`

---

## 10. 빌드 오류 수정

### 수정 사항
- **optVoteDelta**: 선언되었으나 사용되지 않는 변수 제거
- **Poll 인터페이스**: `createdAt?: number` 속성 추가 (정렬용)

---

## 11. 모바일 반응형 및 추가 기능 (세션 2)

### 모바일 최적화
- 뷰포트 메타 태그, `theme-color` 추가
- 터치 최소 영역 44px, `touch-manipulation` 적용
- 반응형 헤더·탭 (모바일에서 간소화)
- `min-h-[100dvh]` 적용

### 일정 탭 - 캘린더 중심 뷰
- 상단에 한 달 캘린더 (월 단위 네비게이션)
- 캘린더 아래 "전체 일정" 목록 (날짜 순, 월 제한 없음)
- 5개씩 더보기 + 스켈레톤 로딩
- 캘린더/목록에서 일정 클릭 시 **우측 패널**에 상세 표시 (참/불, 댓글, 수정/삭제)

### 일정 댓글 기능
- 일정 상세에 댓글 섹션 추가
- Firestore `schedules/{id}/comments` 서브컬렉션
- 의견, 확답 예정일 등 자유 입력

### 참/불 이름 표시
- **최초 접속 시 이름 선택** (17명 목록, 가나다순 정렬)
- localStorage에 저장, 재방문 시 선택 화면 생략
- 참/불/미정 시 선택한 이름으로 표시 (예: 참: 지운, 대성)

### 홈 화면 개선
- 일정 카드에 **수정(연필)**·**삭제(휴지통)** 버튼 추가
- "최근 투표" → **"투표 (N)"** (총 개수 표시)

### 투표 기능 개선
- **투표 수정 허용**: 단일 선택도 다른 항목 클릭 시 변경 가능
- **투표 기간**: 마감일(선택) 추가, 종료 시 "종료됨" 표시
- **투표자 표시**: 익명이 아닌 경우 각 항목별 누가 투표했는지 표시 (`voterDisplayNames`)
- 체크박스 UI 개선 (CheckSquare 아이콘 → 커스텀 박스+체크)

### Git 연결
- 원격 저장소 `https://github.com/Anakin787/cleaning-tool-cal` 연결
- `origin/main` 병합 후 push

---

## 12. 삭제 확인 모달

### 배경
- 브라우저 기본 `confirm()`이 PWA·모바일 환경에서 동작하지 않는 경우 존재
- 사용자 요청: 삭제 전 확인 안내창 표시

### 작업 내용
- **커스텀 삭제 확인 모달** 구현 (native `confirm` 대체)
- 일정/투표 삭제 버튼 클릭 시 모달 표시: "삭제하시겠습니까?"
- 취소 / 삭제 버튼 제공
- `deleteConfirm` 상태로 모달 표시 제어
- 배경 클릭 시 모달 닫힘 (취소와 동일)

### 적용 위치
- 홈 화면 일정 카드 삭제
- 일정 탭 (캘린더/목록) 일정 상세 삭제
- 투표 탭 투표 삭제

---

## 파일 변경 요약

| 파일 | 변경 내용 |
|------|----------|
| `src/App.tsx` | 핵심 로직 및 UI 대부분 |
| `src/config.ts` | Firebase 설정 |
| `src/main.tsx` | 앱 진입점 |
| `vite.config.ts` | Vite 설정 + base path |
| `package.json` | 의존성 정의 |
| `.github/workflows/deploy.yml` | GitHub Pages 배포 워크플로우 |
| `.gitignore` | Git 제외 파일 |
| `README.md` | 프로젝트 설명 및 배포 안내 |

---

## 기술 스택

- **프레임워크**: React 18
- **빌드 도구**: Vite 5
- **스타일**: Tailwind CSS (CDN)
- **백엔드**: Firebase (Auth, Firestore)
- **아이콘**: Lucide React
